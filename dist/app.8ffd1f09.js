parcelRequire=function(e,r,t,n){var i,o="function"==typeof parcelRequire&&parcelRequire,u="function"==typeof require&&require;function f(t,n){if(!r[t]){if(!e[t]){var i="function"==typeof parcelRequire&&parcelRequire;if(!n&&i)return i(t,!0);if(o)return o(t,!0);if(u&&"string"==typeof t)return u(t);var c=new Error("Cannot find module '"+t+"'");throw c.code="MODULE_NOT_FOUND",c}p.resolve=function(r){return e[t][1][r]||r},p.cache={};var l=r[t]=new f.Module(t);e[t][0].call(l.exports,p,l,l.exports,this)}return r[t].exports;function p(e){return f(p.resolve(e))}}f.isParcelRequire=!0,f.Module=function(e){this.id=e,this.bundle=f,this.exports={}},f.modules=e,f.cache=r,f.parent=o,f.register=function(r,t){e[r]=[function(e,r){r.exports=t},{}]};for(var c=0;c<t.length;c++)try{f(t[c])}catch(e){i||(i=e)}if(t.length){var l=f(t[t.length-1]);"object"==typeof exports&&"undefined"!=typeof module?module.exports=l:"function"==typeof define&&define.amd?define(function(){return l}):n&&(this[n]=l)}if(parcelRequire=f,i)throw i;return f}({"rH1J":[function(require,module,exports) {

var t,e,n=module.exports={};function r(){throw new Error("setTimeout has not been defined")}function o(){throw new Error("clearTimeout has not been defined")}function i(e){if(t===setTimeout)return setTimeout(e,0);if((t===r||!t)&&setTimeout)return t=setTimeout,setTimeout(e,0);try{return t(e,0)}catch(n){try{return t.call(null,e,0)}catch(n){return t.call(this,e,0)}}}function u(t){if(e===clearTimeout)return clearTimeout(t);if((e===o||!e)&&clearTimeout)return e=clearTimeout,clearTimeout(t);try{return e(t)}catch(n){try{return e.call(null,t)}catch(n){return e.call(this,t)}}}!function(){try{t="function"==typeof setTimeout?setTimeout:r}catch(n){t=r}try{e="function"==typeof clearTimeout?clearTimeout:o}catch(n){e=o}}();var c,s=[],l=!1,a=-1;function f(){l&&c&&(l=!1,c.length?s=c.concat(s):a=-1,s.length&&h())}function h(){if(!l){var t=i(f);l=!0;for(var e=s.length;e;){for(c=s,s=[];++a<e;)c&&c[a].run();a=-1,e=s.length}c=null,l=!1,u(t)}}function m(t,e){this.fun=t,this.array=e}function p(){}n.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)e[n-1]=arguments[n];s.push(new m(t,e)),1!==s.length||l||i(h)},m.prototype.run=function(){this.fun.apply(null,this.array)},n.title="browser",n.env={},n.argv=[],n.version="",n.versions={},n.on=p,n.addListener=p,n.once=p,n.off=p,n.removeListener=p,n.removeAllListeners=p,n.emit=p,n.prependListener=p,n.prependOnceListener=p,n.listeners=function(t){return[]},n.binding=function(t){throw new Error("process.binding is not supported")},n.cwd=function(){return"/"},n.chdir=function(t){throw new Error("process.chdir is not supported")},n.umask=function(){return 0};
},{}],"VM5B":[function(require,module,exports) {
var define;
var global = arguments[3];
var process = require("process");
var t,e=arguments[3],n=require("process");!function(e,n){"object"==typeof exports&&"undefined"!=typeof module?module.exports=n():"function"==typeof t&&t.amd?t(n):e.ES6Promise=n()}(this,function(){"use strict";function t(t){return"function"==typeof t}var r=Array.isArray?Array.isArray:function(t){return"[object Array]"===Object.prototype.toString.call(t)},o=0,i=void 0,s=void 0,u=function(t,e){p[o]=t,p[o+1]=e,2===(o+=2)&&(s?s(_):w())};var c="undefined"!=typeof window?window:void 0,a=c||{},f=a.MutationObserver||a.WebKitMutationObserver,l="undefined"==typeof self&&void 0!==n&&"[object process]"==={}.toString.call(n),h="undefined"!=typeof Uint8ClampedArray&&"undefined"!=typeof importScripts&&"undefined"!=typeof MessageChannel;function v(){var t=setTimeout;return function(){return t(_,1)}}var p=new Array(1e3);function _(){for(var t=0;t<o;t+=2){(0,p[t])(p[t+1]),p[t]=void 0,p[t+1]=void 0}o=0}var d,y,m,b,w=void 0;function g(t,e){var n=this,r=new this.constructor(S);void 0===r[j]&&K(r);var o=n._state;if(o){var i=arguments[o-1];u(function(){return k(o,r,i,n._result)})}else F(n,r,t,e);return r}function A(t){if(t&&"object"==typeof t&&t.constructor===this)return t;var e=new this(S);return x(e,t),e}l?w=function(){return n.nextTick(_)}:f?(y=0,m=new f(_),b=document.createTextNode(""),m.observe(b,{characterData:!0}),w=function(){b.data=y=++y%2}):h?((d=new MessageChannel).port1.onmessage=_,w=function(){return d.port2.postMessage(0)}):w=void 0===c&&"function"==typeof require?function(){try{var t=Function("return this")().require("vertx");return void 0!==(i=t.runOnLoop||t.runOnContext)?function(){i(_)}:v()}catch(e){return v()}}():v();var j=Math.random().toString(36).substring(2);function S(){}var E=void 0,T=1,M=2;function P(e,n,r){n.constructor===e.constructor&&r===g&&n.constructor.resolve===A?function(t,e){e._state===T?O(t,e._result):e._state===M?q(t,e._result):F(e,void 0,function(e){return x(t,e)},function(e){return q(t,e)})}(e,n):void 0===r?O(e,n):t(r)?function(t,e,n){u(function(t){var r=!1,o=function(t,e,n,r){try{t.call(e,n,r)}catch(o){return o}}(n,e,function(n){r||(r=!0,e!==n?x(t,n):O(t,n))},function(e){r||(r=!0,q(t,e))},t._label);!r&&o&&(r=!0,q(t,o))},t)}(e,n,r):O(e,n)}function x(t,e){if(t===e)q(t,new TypeError("You cannot resolve a promise with itself"));else if(o=typeof(r=e),null===r||"object"!==o&&"function"!==o)O(t,e);else{var n=void 0;try{n=e.then}catch(i){return void q(t,i)}P(t,e,n)}var r,o}function C(t){t._onerror&&t._onerror(t._result),Y(t)}function O(t,e){t._state===E&&(t._result=e,t._state=T,0!==t._subscribers.length&&u(Y,t))}function q(t,e){t._state===E&&(t._state=M,t._result=e,u(C,t))}function F(t,e,n,r){var o=t._subscribers,i=o.length;t._onerror=null,o[i]=e,o[i+T]=n,o[i+M]=r,0===i&&t._state&&u(Y,t)}function Y(t){var e=t._subscribers,n=t._state;if(0!==e.length){for(var r=void 0,o=void 0,i=t._result,s=0;s<e.length;s+=3)r=e[s],o=e[s+n],r?k(n,r,o,i):o(i);t._subscribers.length=0}}function k(e,n,r,o){var i=t(r),s=void 0,u=void 0,c=!0;if(i){try{s=r(o)}catch(a){c=!1,u=a}if(n===s)return void q(n,new TypeError("A promises callback cannot return that same promise."))}else s=o;n._state!==E||(i&&c?x(n,s):!1===c?q(n,u):e===T?O(n,s):e===M&&q(n,s))}var D=0;function K(t){t[j]=D++,t._state=void 0,t._result=void 0,t._subscribers=[]}var L=function(){function t(t,e){this._instanceConstructor=t,this.promise=new t(S),this.promise[j]||K(this.promise),r(e)?(this.length=e.length,this._remaining=e.length,this._result=new Array(this.length),0===this.length?O(this.promise,this._result):(this.length=this.length||0,this._enumerate(e),0===this._remaining&&O(this.promise,this._result))):q(this.promise,new Error("Array Methods must be provided an Array"))}return t.prototype._enumerate=function(t){for(var e=0;this._state===E&&e<t.length;e++)this._eachEntry(t[e],e)},t.prototype._eachEntry=function(t,e){var n=this._instanceConstructor,r=n.resolve;if(r===A){var o=void 0,i=void 0,s=!1;try{o=t.then}catch(c){s=!0,i=c}if(o===g&&t._state!==E)this._settledAt(t._state,e,t._result);else if("function"!=typeof o)this._remaining--,this._result[e]=t;else if(n===N){var u=new n(S);s?q(u,i):P(u,t,o),this._willSettleAt(u,e)}else this._willSettleAt(new n(function(e){return e(t)}),e)}else this._willSettleAt(r(t),e)},t.prototype._settledAt=function(t,e,n){var r=this.promise;r._state===E&&(this._remaining--,t===M?q(r,n):this._result[e]=n),0===this._remaining&&O(r,this._result)},t.prototype._willSettleAt=function(t,e){var n=this;F(t,void 0,function(t){return n._settledAt(T,e,t)},function(t){return n._settledAt(M,e,t)})},t}();var N=function(){function e(t){this[j]=D++,this._result=this._state=void 0,this._subscribers=[],S!==t&&("function"!=typeof t&&function(){throw new TypeError("You must pass a resolver function as the first argument to the promise constructor")}(),this instanceof e?function(t,e){try{e(function(e){x(t,e)},function(e){q(t,e)})}catch(n){q(t,n)}}(this,t):function(){throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.")}())}return e.prototype.catch=function(t){return this.then(null,t)},e.prototype.finally=function(e){var n=this.constructor;return t(e)?this.then(function(t){return n.resolve(e()).then(function(){return t})},function(t){return n.resolve(e()).then(function(){throw t})}):this.then(e,e)},e}();return N.prototype.then=g,N.all=function(t){return new L(this,t).promise},N.race=function(t){var e=this;return r(t)?new e(function(n,r){for(var o=t.length,i=0;i<o;i++)e.resolve(t[i]).then(n,r)}):new e(function(t,e){return e(new TypeError("You must pass an array to race."))})},N.resolve=A,N.reject=function(t){var e=new this(S);return q(e,t),e},N._setScheduler=function(t){s=t},N._setAsap=function(t){u=t},N._asap=u,N.polyfill=function(){var t=void 0;if(void 0!==e)t=e;else if("undefined"!=typeof self)t=self;else try{t=Function("return this")()}catch(o){throw new Error("polyfill failed because global object is unavailable in this environment")}var n=t.Promise;if(n){var r=null;try{r=Object.prototype.toString.call(n.resolve())}catch(o){}if("[object Promise]"===r&&!n.cast)return}t.Promise=N},N.Promise=N,N});
},{"process":"rH1J"}],"rL8E":[function(require,module,exports) {
"use strict";module.exports=require("./").polyfill();
},{"./":"VM5B"}],"a0bR":[function(require,module,exports) {
var global = arguments[3];
var t=arguments[3];!function(t){"use strict";var n,r=function(){try{if(t.URLSearchParams&&"bar"===new t.URLSearchParams("foo=bar").get("foo"))return t.URLSearchParams}catch(n){}return null}(),e=r&&"a=1"===new r({a:1}).toString(),o=r&&"+"===new r("s=%2B").get("s"),i="__URLSearchParams__",a=!r||((n=new r).append("s"," &"),"s=+%26"===n.toString()),c=h.prototype,s=!(!t.Symbol||!t.Symbol.iterator);if(!(r&&e&&o&&a)){var u;c.append=function(t,n){y(this[i],t,n)},c.delete=function(t){delete this[i][t]},c.get=function(t){var n=this[i];return this.has(t)?n[t][0]:null},c.getAll=function(t){var n=this[i];return this.has(t)?n[t].slice(0):[]},c.has=function(t){return d(this[i],t)},c.set=function(t,n){this[i][t]=[""+n]},c.toString=function(){var t,n,r,e,o=this[i],a=[];for(n in o)for(r=l(n),t=0,e=o[n];t<e.length;t++)a.push(r+"="+l(e[t]));return a.join("&")},!!o&&r&&!e&&t.Proxy?(u=new Proxy(r,{construct:function(t,n){return new t(new h(n[0]).toString())}})).toString=Function.prototype.toString.bind(h):u=h,Object.defineProperty(t,"URLSearchParams",{value:u});var f=t.URLSearchParams.prototype;f.polyfill=!0,f.forEach=f.forEach||function(t,n){var r=v(this.toString());Object.getOwnPropertyNames(r).forEach(function(e){r[e].forEach(function(r){t.call(n,r,e,this)},this)},this)},f.sort=f.sort||function(){var t,n,r,e=v(this.toString()),o=[];for(t in e)o.push(t);for(o.sort(),n=0;n<o.length;n++)this.delete(o[n]);for(n=0;n<o.length;n++){var i=o[n],a=e[i];for(r=0;r<a.length;r++)this.append(i,a[r])}},f.keys=f.keys||function(){var t=[];return this.forEach(function(n,r){t.push(r)}),g(t)},f.values=f.values||function(){var t=[];return this.forEach(function(n){t.push(n)}),g(t)},f.entries=f.entries||function(){var t=[];return this.forEach(function(n,r){t.push([r,n])}),g(t)},s&&(f[t.Symbol.iterator]=f[t.Symbol.iterator]||f.entries)}function h(t){((t=t||"")instanceof URLSearchParams||t instanceof h)&&(t=t.toString()),this[i]=v(t)}function l(t){var n={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(t).replace(/[!'\(\)~]|%20|%00/g,function(t){return n[t]})}function p(t){return t.replace(/[ +]/g,"%20").replace(/(%[a-f0-9]{2})+/gi,function(t){return decodeURIComponent(t)})}function g(n){var r={next:function(){var t=n.shift();return{done:void 0===t,value:t}}};return s&&(r[t.Symbol.iterator]=function(){return r}),r}function v(t){var n={};if("object"==typeof t)if(S(t))for(var r=0;r<t.length;r++){var e=t[r];if(!S(e)||2!==e.length)throw new TypeError("Failed to construct 'URLSearchParams': Sequence initializer must only contain pair elements");y(n,e[0],e[1])}else for(var o in t)t.hasOwnProperty(o)&&y(n,o,t[o]);else{0===t.indexOf("?")&&(t=t.slice(1));for(var i=t.split("&"),a=0;a<i.length;a++){var c=i[a],s=c.indexOf("=");-1<s?y(n,p(c.slice(0,s)),p(c.slice(s+1))):c&&y(n,p(c),"")}}return n}function y(t,n,r){var e="string"==typeof r?r:null!=r&&"function"==typeof r.toString?r.toString():JSON.stringify(r);d(t,n)?t[n].push(e):t[n]=[e]}function S(t){return!!t&&"[object Array]"===Object.prototype.toString.call(t)}function d(t,n){return Object.prototype.hasOwnProperty.call(t,n)}}(void 0!==t?t:"undefined"!=typeof window?window:this);
},{}],"sCpQ":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.showMessage=n,exports.isCoordOnColumn=t,exports.getColumnFromCoord=s,exports.getRandomColumnNumber=i,exports.choose=a,exports.animationFrame=u,exports.clone=d,exports.getMockPlayerAction=c,exports.onresize=l,exports.BIG_NEGATIVE_NUMBER=exports.BIG_POSITIVE_NUMBER=void 0;var e=require("./board/base"),r=Math.pow(10,9)+7;exports.BIG_POSITIVE_NUMBER=r;var o=-r;function n(e){void 0===e&&(e="");var r=document.querySelector(".message");if(!r)return console.error("Message DOM is null!");r.classList.remove("hidden");var o=document.querySelector(".message-body-content");if(!o)return console.error("Message body content DOM is null!");o.innerHTML=e;var n=document.querySelector(".message-body-dismiss");if(!n)return console.error("Message body dismiss DOM is null!");n.addEventListener("click",function e(){r.classList.add("invisible"),r.addEventListener("transitionend",function(){r.classList.add("hidden"),r.classList.remove("invisible")}),n.removeEventListener("click",e)})}function t(e,r,o){return(e.x-r)*(e.x-r)<=o*o}function s(r){for(var o=0;o<e.BoardBase.COLUMNS;o++)if(t(r,3*e.BoardBase.PIECE_RADIUS*o+e.BoardBase.MASK_X_BEGIN+2*e.BoardBase.PIECE_RADIUS,e.BoardBase.PIECE_RADIUS))return o;return-1}function i(){return Math.floor(Math.random()*e.BoardBase.COLUMNS)}function a(e){return e[Math.floor(Math.random()*e.length)]}function u(){var e=null,r=new Promise(function(r){return e=r});return e&&window.requestAnimationFrame(e),r}function d(e){for(var r=[],o=0;o<e.length;o++)r[o]=e[o].slice();return r}function c(r,o,n){var t=d(r);if(t[0][n]!==e.BoardPiece.EMPTY||n<0||n>=e.BoardBase.COLUMNS)return{success:!1,map:t};for(var s=!1,i=0,a=0;a<e.BoardBase.ROWS-1;a++)if(t[a+1][n]!==e.BoardPiece.EMPTY){s=!0,i=a;break}return s||(i=e.BoardBase.ROWS-1),t[i][n]=o,{success:!0,map:t}}function l(){var e=[],r=!1;function o(){r||(r=!0,window.requestAnimationFrame?window.requestAnimationFrame(n):setTimeout(n,66))}function n(){e.forEach(function(e){e()}),r=!1}return{add:function(r){e.length||window.addEventListener("resize",o),function(r){r&&e.push(r)}(r)}}}exports.BIG_NEGATIVE_NUMBER=o;
},{"./board/base":"jF23"}],"jF23":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.BoardBase=exports.BoardPiece=void 0;var e,t=require("../utils"),r=function(e,t,r,n){return new(r||(r=Promise))(function(o,i){function a(e){try{c(n.next(e))}catch(t){i(t)}}function u(e){try{c(n.throw(e))}catch(t){i(t)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r(function(e){e(t)})).then(a,u)}c((n=n.apply(e,t||[])).next())})},n=function(e,t){var r,n,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(i){return function(u){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,n&&(o=2&i[0]?n.return:i[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,i[1])).done)return o;switch(n=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,n=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(u){i=[6,u],n=0}finally{r=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,u])}}};exports.BoardPiece=e,function(e){e[e.EMPTY=0]="EMPTY",e[e.PLAYER_1=1]="PLAYER_1",e[e.PLAYER_2=2]="PLAYER_2",e[e.DRAW=3]="DRAW"}(e||(exports.BoardPiece=e={}));var o=function(){function o(){this.map=[],this.winnerBoardPiece=e.EMPTY,this.initConstants(),this.reset()}return o.prototype.reset=function(){this.map=[];for(var t=0;t<o.ROWS;t++){this.map.push([]);for(var r=0;r<o.COLUMNS;r++)this.map[t].push(e.EMPTY)}this.winnerBoardPiece=e.EMPTY},o.prototype.initConstants=function(){o.CANVAS_HEIGHT=480*o.SCALE,o.CANVAS_WIDTH=640*o.SCALE,o.PIECE_RADIUS=25*o.SCALE,o.MASK_X_BEGIN=Math.max(0,o.CANVAS_WIDTH-(3*o.COLUMNS+1)*o.PIECE_RADIUS)/2,o.MASK_Y_BEGIN=Math.max(0,o.CANVAS_HEIGHT-(3*o.ROWS+1)*o.PIECE_RADIUS)/2,o.MESSAGE_WIDTH=400*o.SCALE,o.MESSAGE_X_BEGIN=(o.CANVAS_WIDTH-o.MESSAGE_WIDTH)/2,o.MESSAGE_Y_BEGIN=20*o.SCALE},o.prototype.applyPlayerAction=function(e,o){return r(this,void 0,Promise,function(){var r,i,a;return n(this,function(n){return r=(0,t.getMockPlayerAction)(this.map,e.boardPiece,o),i=r.success,a=r.map,this.map=a,[2,i]})})},o.prototype.debug=function(){console.log(this.map.map(function(e){return e.join(" ")}).join("\n"))},o.prototype.getWinner=function(){var t=this;if(this.winnerBoardPiece!==e.EMPTY)return this.winnerBoardPiece;for(var r=[[0,-1],[0,1],[-1,-1],[-1,0],[-1,1],[1,-1],[1,0],[1,1]],n=function e(r,n,i,a,u){return u>=4||!(r<0||n<0||r>=o.ROWS||n>=o.COLUMNS||t.map[r][n]!==i)&&e(r+a[0],n+a[1],i,a,u+1)},i=0,a=0;a<o.ROWS;a++)for(var u=0;u<o.COLUMNS;u++){var c=this.map[a][u];if(c!==e.EMPTY)for(var s=0;s<r.length;s++){if(n(a+r[s][0],u+r[s][1],c,r[s],1))return this.winnerBoardPiece=c}else i++}return 0===i?this.winnerBoardPiece=e.DRAW:e.EMPTY},o.prototype.getPlayerColor=function(t){switch(t){case e.PLAYER_1:return o.PLAYER_1_COLOR;case e.PLAYER_2:return o.PLAYER_2_COLOR;default:return"transparent"}},o.ROWS=6,o.COLUMNS=7,o.PLAYER_1_COLOR="#ef453b",o.PLAYER_2_COLOR="#0059ff",o.PIECE_STROKE_STYLE="black",o.MASK_COLOR="#d8d8d8",o}();exports.BoardBase=o;
},{"../utils":"sCpQ"}],"jQwk":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("./base");Object.keys(e).forEach(function(r){"default"!==r&&"__esModule"!==r&&(r in exports&&exports[r]===e[r]||Object.defineProperty(exports,r,{enumerable:!0,get:function(){return e[r]}}))});
},{"./base":"jF23"}],"pYRP":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Player=void 0;var e=function(){return function(e){this.boardPiece=e}}();exports.Player=e;
},{}],"NSCV":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.PlayerAi=void 0;var e=require("./player"),t=require("../board"),r=require("../utils"),o=function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(t,r)};return function(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function o(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(o.prototype=r.prototype,new o)}}(),a=function(e,t,r,o){return new(r||(r=Promise))(function(a,n){function i(e){try{u(o.next(e))}catch(t){n(t)}}function c(e){try{u(o.throw(e))}catch(t){n(t)}}function u(e){var t;e.done?a(e.value):(t=e.value,t instanceof r?t:new r(function(e){e(t)})).then(i,c)}u((o=o.apply(e,t||[])).next())})},n=function(e,t){var r,o,a,n,i={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return n={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(n[Symbol.iterator]=function(){return this}),n;function c(n){return function(c){return function(n){if(r)throw new TypeError("Generator is already executing.");for(;i;)try{if(r=1,o&&(a=2&n[0]?o.return:n[0]?o.throw||((a=o.return)&&a.call(o),0):o.next)&&!(a=a.call(o,n[1])).done)return a;switch(o=0,a&&(n=[2&n[0],a.value]),n[0]){case 0:case 1:a=n;break;case 4:return i.label++,{value:n[1],done:!1};case 5:i.label++,o=n[1],n=[0];continue;case 7:n=i.ops.pop(),i.trys.pop();continue;default:if(!(a=(a=i.trys).length>0&&a[a.length-1])&&(6===n[0]||2===n[0])){i=0;continue}if(3===n[0]&&(!a||n[1]>a[0]&&n[1]<a[3])){i.label=n[1];break}if(6===n[0]&&i.label<a[1]){i.label=a[1],a=n;break}if(a&&i.label<a[2]){i.label=a[2],i.ops.push(n);break}a[2]&&i.ops.pop(),i.trys.pop();continue}n=t.call(e,i)}catch(c){n=[6,c],o=0}finally{r=a=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}([n,c])}}},i=function(e){function i(r){var o=e.call(this,r)||this;return o.ownBoardPieceValue=o.getBoardPieceValue(r),o.enemyBoardPiece=r===t.BoardPiece.PLAYER_1?t.BoardPiece.PLAYER_2:t.BoardPiece.PLAYER_1,o}return o(i,e),i.prototype.getBoardPieceValue=function(e){return e===t.BoardPiece.EMPTY?0:e===this.boardPiece?1:-1},i.prototype.getStateValue=function(e){for(var r=t.BoardPiece.EMPTY,o=0,a=0;a<t.BoardBase.ROWS;a++)for(var n=0;n<t.BoardBase.COLUMNS;n++){for(var i=0,c=0,u=0,s=0,l=0;l<=3;l++)n+l<t.BoardBase.COLUMNS&&(i+=this.getBoardPieceValue(e[a][n+l])),a+l<t.BoardBase.ROWS&&(c+=this.getBoardPieceValue(e[a+l][n])),a+l<t.BoardBase.ROWS&&n+l<t.BoardBase.COLUMNS&&(u+=this.getBoardPieceValue(e[a+l][n+l])),a-l>=0&&n+l<7&&(s+=this.getBoardPieceValue(e[a-l][n+l]));o+=i*i*i,o+=c*c*c,o+=u*u*u,o+=s*s*s,4===Math.abs(i)?r=i>0?this.boardPiece:this.enemyBoardPiece:4===Math.abs(c)?r=c>0?this.boardPiece:this.enemyBoardPiece:4===Math.abs(u)?r=u>0?this.boardPiece:this.enemyBoardPiece:4===Math.abs(s)&&(r=s>0?this.boardPiece:this.enemyBoardPiece)}return{winnerBoardPiece:r,chain:o}},i.prototype.transformValues=function(e,t,o){var a=t===this.boardPiece,n=t===this.enemyBoardPiece;return a?e=r.BIG_POSITIVE_NUMBER-100:n&&(e=r.BIG_NEGATIVE_NUMBER+100),e-=o*o},i.prototype.getMove=function(e,t,r,o){var a=this.getStateValue(e),n=a.winnerBoardPiece===this.boardPiece,c=a.winnerBoardPiece===this.enemyBoardPiece;return t>=i.MAX_DEPTH||n||c?{value:this.transformValues(a.chain*this.ownBoardPieceValue,a.winnerBoardPiece,t),move:-1}:t%2==0?this.minState(e,t+1,r,o):this.maxState(e,t+1,r,o)},i.prototype.maxState=function(e,o,a,n){for(var i=r.BIG_NEGATIVE_NUMBER,c=[],u=0;u<t.BoardBase.COLUMNS;u++){var s=(0,r.getMockPlayerAction)(e,this.boardPiece,u),l=s.success,h=s.map;if(l){var f=this.getMove(h,o,a,n).value;if(f>i?(i=f,c=[u]):f===i&&c.push(u),i>n)return{value:i,move:(0,r.choose)(c)};a=Math.max(a,i)}}return{value:i,move:(0,r.choose)(c)}},i.prototype.minState=function(e,o,a,n){for(var i=r.BIG_POSITIVE_NUMBER,c=[],u=0;u<t.BoardBase.COLUMNS;u++){var s=(0,r.getMockPlayerAction)(e,this.enemyBoardPiece,u),l=s.success,h=s.map;if(l){var f=this.getMove(h,o,a,n).value;if(f<i?(i=f,c=[u]):f===i&&c.push(u),i<a)return{value:i,move:(0,r.choose)(c)};n=Math.min(n,i)}}return{value:i,move:(0,r.choose)(c)}},i.prototype.getAction=function(e){return a(this,void 0,Promise,function(){var t,o;return n(this,function(a){return t=(0,r.clone)(e.map),o=this.maxState(t,0,r.BIG_NEGATIVE_NUMBER,r.BIG_POSITIVE_NUMBER),console.log("AI "+this.boardPiece+" choose column "+o.move+" with value of "+o.value),[2,o.move]})})},i.MAX_DEPTH=4,i}(e.Player);exports.PlayerAi=i;
},{"./player":"pYRP","../board":"jQwk","../utils":"sCpQ"}],"N9aC":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.PlayerHuman=void 0;var r=require("./player"),t=require("../board"),e=function(){var r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,t){r.__proto__=t}||function(r,t){for(var e in t)Object.prototype.hasOwnProperty.call(t,e)&&(r[e]=t[e])})(t,e)};return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}}(),o=function(r){function o(t){var e=r.call(this,t)||this;return e.clickPromiseResolver=null,e}return e(o,r),o.prototype.doAction=function(r){this.clickPromiseResolver&&0<=r&&r<t.BoardBase.COLUMNS&&this.clickPromiseResolver(r)},o.prototype.getAction=function(r){var t=this;return new Promise(function(r){return t.clickPromiseResolver=r})},o}(r.Player);exports.PlayerHuman=o;
},{"./player":"pYRP","../board":"jQwk"}],"KpsM":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.PlayerShadow=void 0;var t=require("./player"),o=require("../board"),r=function(){var t=function(o,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,o){t.__proto__=o}||function(t,o){for(var r in o)Object.prototype.hasOwnProperty.call(o,r)&&(t[r]=o[r])})(o,r)};return function(o,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function e(){this.constructor=o}t(o,r),o.prototype=null===r?Object.create(r):(e.prototype=r.prototype,new e)}}(),e=function(t){function e(o){var r=t.call(this,o)||this;return r.actionPromiseResolver=null,r}return r(e,t),e.prototype.doAction=function(t){this.actionPromiseResolver&&0<=t&&t<o.BoardBase.COLUMNS&&this.actionPromiseResolver(t)},e.prototype.getAction=function(t){var o=this;return new Promise(function(t){return o.actionPromiseResolver=t})},e}(t.Player);exports.PlayerShadow=e;
},{"./player":"pYRP","../board":"jQwk"}],"RSqW":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("./player");Object.keys(e).forEach(function(r){"default"!==r&&"__esModule"!==r&&(r in exports&&exports[r]===e[r]||Object.defineProperty(exports,r,{enumerable:!0,get:function(){return e[r]}}))});var r=require("./player-ai");Object.keys(r).forEach(function(e){"default"!==e&&"__esModule"!==e&&(e in exports&&exports[e]===r[e]||Object.defineProperty(exports,e,{enumerable:!0,get:function(){return r[e]}}))});var t=require("./player-human");Object.keys(t).forEach(function(e){"default"!==e&&"__esModule"!==e&&(e in exports&&exports[e]===t[e]||Object.defineProperty(exports,e,{enumerable:!0,get:function(){return t[e]}}))});var o=require("./player-shadow");Object.keys(o).forEach(function(e){"default"!==e&&"__esModule"!==e&&(e in exports&&exports[e]===o[e]||Object.defineProperty(exports,e,{enumerable:!0,get:function(){return o[e]}}))});
},{"./player":"pYRP","./player-ai":"NSCV","./player-human":"N9aC","./player-shadow":"KpsM"}],"v8Qh":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.drawCircle=e,exports.drawMask=a,exports.clearCanvas=o;var r=require("./index");function e(r,e){var a=e.x,o=void 0===a?0:a,t=e.y,i=void 0===t?0:t,d=e.r,l=void 0===d?0:d,s=e.fillStyle,c=void 0===s?"":s,v=e.strokeStyle,n=void 0===v?"":v;r.save(),r.fillStyle=c,r.strokeStyle=n,r.beginPath(),r.arc(o,i,l,0,2*Math.PI,!1),r.fill(),r.restore()}function a(e){var a=e.context;a.save(),a.fillStyle=r.Board.MASK_COLOR,a.beginPath();for(var o=2*r.Board.PIECE_RADIUS,t=3*r.Board.PIECE_RADIUS,i=0;i<r.Board.ROWS;i++)for(var d=0;d<r.Board.COLUMNS;d++)a.arc(t*d+r.Board.MASK_X_BEGIN+o,t*i+r.Board.MASK_Y_BEGIN+o,r.Board.PIECE_RADIUS,0,2*Math.PI),a.rect(t*d+r.Board.MASK_X_BEGIN+2*o,t*i+r.Board.MASK_Y_BEGIN,-2*o,2*o);a.fill(),a.restore()}function o(r){r.context.clearRect(0,0,r.canvas.width,r.canvas.height)}
},{"./index":"fomW"}],"fomW":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Board=void 0;var t=require("@kenrick95/c4/src/board"),e=require("@kenrick95/c4/src/utils"),r=require("./utils"),n=function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(e,r)};return function(e,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),a=function(t,e,r,n){return new(r||(r=Promise))(function(a,o){function i(t){try{c(n.next(t))}catch(e){o(e)}}function s(t){try{c(n.throw(t))}catch(e){o(e)}}function c(t){var e;t.done?a(t.value):(e=t.value,e instanceof r?e:new r(function(t){t(e)})).then(i,s)}c((n=n.apply(t,e||[])).next())})},o=function(t,e){var r,n,a,o,i={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(r)throw new TypeError("Generator is already executing.");for(;i;)try{if(r=1,n&&(a=2&o[0]?n.return:o[0]?n.throw||((a=n.return)&&a.call(n),0):n.next)&&!(a=a.call(n,o[1])).done)return a;switch(n=0,a&&(o=[2&o[0],a.value]),o[0]){case 0:case 1:a=o;break;case 4:return i.label++,{value:o[1],done:!1};case 5:i.label++,n=o[1],o=[0];continue;case 7:o=i.ops.pop(),i.trys.pop();continue;default:if(!(a=(a=i.trys).length>0&&a[a.length-1])&&(6===o[0]||2===o[0])){i=0;continue}if(3===o[0]&&(!a||o[1]>a[0]&&o[1]<a[3])){i.label=o[1];break}if(6===o[0]&&i.label<a[1]){i.label=a[1],a=o;break}if(a&&i.label<a[2]){i.label=a[2],i.ops.push(o);break}a[2]&&i.ops.pop(),i.trys.pop();continue}o=e.call(t,i)}catch(s){o=[6,s],n=0}finally{r=a=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},i=function(i){function s(t){var e=i.call(this)||this;return e.canvas=t,e.context=t.getContext("2d"),e.getBoardScale(),e.initConstants(),e.reset(),e.onresize(),e}return n(s,i),s.prototype.getBoardScale=function(){return window.innerWidth<640?t.BoardBase.SCALE=.5:t.BoardBase.SCALE=1},s.prototype.onresize=function(){var n=this,a=t.BoardBase.SCALE;(0,e.onresize)().add(function(){n.getBoardScale(),a!==t.BoardBase.SCALE&&(a=t.BoardBase.SCALE,n.initConstants(),(0,r.clearCanvas)(n),n.render())})},s.prototype.reset=function(){i.prototype.reset.call(this),this.canvas&&((0,r.clearCanvas)(this),this.render())},s.prototype.initConstants=function(){if(i.prototype.initConstants.call(this),this.canvas){var t=self.devicePixelRatio||1;this.canvas.width=s.CANVAS_WIDTH*t,this.canvas.height=s.CANVAS_HEIGHT*t,this.context.scale(t,t),this.canvas.style.width=s.CANVAS_WIDTH+"px",this.canvas.style.height=s.CANVAS_HEIGHT+"px"}},s.prototype.animateAction=function(n,i,s){return a(this,void 0,Promise,function(){var c,u,l,d=this;return o(this,function(B){switch(B.label){case 0:c=this.getPlayerColor(s),u=0,l=function(){return a(d,void 0,void 0,function(){return o(this,function(e){return(0,r.clearCanvas)(this),(0,r.drawCircle)(this.context,{x:3*t.BoardBase.PIECE_RADIUS*i+t.BoardBase.MASK_X_BEGIN+2*t.BoardBase.PIECE_RADIUS,y:u+t.BoardBase.MASK_Y_BEGIN+2*t.BoardBase.PIECE_RADIUS,r:t.BoardBase.PIECE_RADIUS,fillStyle:c,strokeStyle:t.BoardBase.PIECE_STROKE_STYLE}),this.render(),u+=t.BoardBase.PIECE_RADIUS,[2]})})},B.label=1;case 1:return 3*n*t.BoardBase.PIECE_RADIUS>=u?[4,(0,e.animationFrame)()]:[3,3];case 2:return B.sent(),l(),[3,1];case 3:return[2]}})})},s.prototype.render=function(){(0,r.drawMask)(this);for(var e=0;e<t.BoardBase.ROWS;e++)for(var n=0;n<t.BoardBase.COLUMNS;n++)(0,r.drawCircle)(this.context,{x:3*t.BoardBase.PIECE_RADIUS*n+t.BoardBase.MASK_X_BEGIN+2*t.BoardBase.PIECE_RADIUS,y:3*t.BoardBase.PIECE_RADIUS*e+t.BoardBase.MASK_Y_BEGIN+2*t.BoardBase.PIECE_RADIUS,r:t.BoardBase.PIECE_RADIUS,fillStyle:this.getPlayerColor(this.map[e][n]),strokeStyle:t.BoardBase.PIECE_STROKE_STYLE})},s.prototype.applyPlayerAction=function(r,n){return a(this,void 0,Promise,function(){var a,i,s;return o(this,function(o){switch(o.label){case 0:if(this.map[0][n]!==t.BoardPiece.EMPTY||n<0||n>=t.BoardBase.COLUMNS)return[2,!1];for(a=!1,i=0,s=0;s<t.BoardBase.ROWS-1;s++)if(this.map[s+1][n]!==t.BoardPiece.EMPTY){a=!0,i=s;break}return a||(i=t.BoardBase.ROWS-1),[4,this.animateAction(i,n,r.boardPiece)];case 1:return o.sent(),this.map[i][n]=r.boardPiece,this.debug(),[4,(0,e.animationFrame)()];case 2:return o.sent(),this.render(),[2,!0]}})})},s}(t.BoardBase);exports.Board=i;
},{"@kenrick95/c4/src/board":"jQwk","@kenrick95/c4/src/utils":"sCpQ","./utils":"v8Qh"}],"hcAk":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.GameBase=void 0;var e=require("../board"),t=function(e,t,r,n){return new(r||(r=Promise))(function(o,i){function a(e){try{l(n.next(e))}catch(t){i(t)}}function s(e){try{l(n.throw(e))}catch(t){i(t)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r(function(e){e(t)})).then(a,s)}l((n=n.apply(e,t||[])).next())})},r=function(e,t){var r,n,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,n&&(o=2&i[0]?n.return:i[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,i[1])).done)return o;switch(n=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,n=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(s){i=[6,s],n=0}finally{r=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}},n=function(){function n(e,t){this.isMoveAllowed=!1,this.isGameWon=!1,this.board=t,this.players=e,this.currentPlayerId=0,this.reset()}return n.prototype.reset=function(){this.isMoveAllowed=!1,this.isGameWon=!1,this.board.reset()},n.prototype.start=function(){return t(this,void 0,void 0,function(){var t;return r(this,function(r){switch(r.label){case 0:this.isMoveAllowed=!0,r.label=1;case 1:return this.isGameWon?[3,3]:[4,this.move()];case 2:return r.sent(),(t=this.board.getWinner())!==e.BoardPiece.EMPTY?(console.log("[GameBase] Game over: winner is player ",t),this.isGameWon=!0,this.isMoveAllowed=!1,this.announceWinner(t),[3,3]):[3,1];case 3:return[2]}})})},n.prototype.move=function(){return t(this,void 0,void 0,function(){var e,t,n;return r(this,function(r){switch(r.label){case 0:if(!this.isMoveAllowed)return[2];e=this.players[this.currentPlayerId],t=!1,r.label=1;case 1:return t?[3,4]:(this.waitingForMove(),[4,e.getAction(this.board)]);case 2:return n=r.sent(),this.isMoveAllowed=!1,this.beforeMoveApplied(n),[4,this.board.applyPlayerAction(e,n)];case 3:return t=r.sent(),this.isMoveAllowed=!0,t?this.afterMove(n):console.log("Move not allowed! Try again."),[3,1];case 4:return this.currentPlayerId=this.getNextPlayer(),[2]}})})},n.prototype.announceWinner=function(t){var r,n=(r={},r[e.BoardPiece.DRAW]="draw",r[e.BoardPiece.PLAYER_1]="Player 1",r[e.BoardPiece.PLAYER_2]="Player 2",r[e.BoardPiece.EMPTY]="none",r)[t];console.log("[GameBase] Game over: winner is ",n,t)},n.prototype.getNextPlayer=function(){return 0===this.currentPlayerId?1:0},n}();exports.GameBase=n;
},{"../board":"jQwk"}],"zwtr":[function(require,module,exports) {
"use strict";var E;function _(E,_){return console.log("[ws] send: ",E,_),JSON.stringify({type:E,payload:_||{}})}function N(E){var _=JSON.parse(E);return console.log("[ws] receive: ",_),_}Object.defineProperty(exports,"__esModule",{value:!0}),exports.constructMessage=_,exports.parseMessage=N,exports.MESSAGE_TYPE=void 0,exports.MESSAGE_TYPE=E,function(E){E.NEW_PLAYER_CONNECTION_REQUEST="NEW_PLAYER_CONNECTION_REQUEST",E.NEW_PLAYER_CONNECTION_OK="NEW_PLAYER_CONNECTION_OK",E.NEW_MATCH_REQUEST="NEW_MATCH_REQUEST",E.NEW_MATCH_OK="NEW_MATCH_OK",E.GAME_READY="GAME_READY",E.GAME_ENDED="GAME_ENDED",E.GAME_RESET="GAME_RESET",E.CONNECT_MATCH_REQUEST="CONNECT_MATCH_REQUEST",E.CONNECT_MATCH_OK="CONNECT_MATCH_OK",E.CONNECT_MATCH_FAIL="CONNECT_MATCH_FAIL",E.HUNG_UP="HUNG_UP",E.OTHER_PLAYER_HUNGUP="OTHER_PLAYER_HUNGUP",E.MOVE_MAIN="MOVE_MAIN",E.MOVE_SHADOW="MOVE_SHADOW"}(E||(exports.MESSAGE_TYPE=E={}));
},{}],"cPVS":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("./game-base");Object.keys(e).forEach(function(r){"default"!==r&&"__esModule"!==r&&(r in exports&&exports[r]===e[r]||Object.defineProperty(exports,r,{enumerable:!0,get:function(){return e[r]}}))});var r=require("./game-online/shared");Object.keys(r).forEach(function(e){"default"!==e&&"__esModule"!==e&&(e in exports&&exports[e]===r[e]||Object.defineProperty(exports,e,{enumerable:!0,get:function(){return r[e]}}))});
},{"./game-base":"hcAk","./game-online/shared":"zwtr"}],"nVOy":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.initGameLocal=y,exports.GameLocal=void 0;var e=require("../board"),t=require("@kenrick95/c4/src/board"),n=require("@kenrick95/c4/src/game"),r=require("@kenrick95/c4/src/player"),o=require("@kenrick95/c4/src/utils"),a=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(t,n)};return function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),i=function(e,t,n,r){return new(n||(n=Promise))(function(o,a){function i(e){try{u(r.next(e))}catch(t){a(t)}}function c(e){try{u(r.throw(e))}catch(t){a(t)}}function u(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(i,c)}u((r=r.apply(e,t||[])).next())})},c=function(e,t){var n,r,o,a,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return a={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function c(a){return function(c){return function(a){if(n)throw new TypeError("Generator is already executing.");for(;i;)try{if(n=1,r&&(o=2&a[0]?r.return:a[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,a[1])).done)return o;switch(r=0,o&&(a=[2&a[0],o.value]),a[0]){case 0:case 1:o=a;break;case 4:return i.label++,{value:a[1],done:!1};case 5:i.label++,r=a[1],a=[0];continue;case 7:a=i.ops.pop(),i.trys.pop();continue;default:if(!(o=(o=i.trys).length>0&&o[o.length-1])&&(6===a[0]||2===a[0])){i=0;continue}if(3===a[0]&&(!o||a[1]>o[0]&&a[1]<o[3])){i.label=a[1];break}if(6===a[0]&&i.label<o[1]){i.label=o[1],o=a;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(a);break}o[2]&&i.ops.pop(),i.trys.pop();continue}a=t.call(e,i)}catch(c){a=[6,c],r=0}finally{n=o=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,c])}}},u=document.querySelector(".statusbox"),s=document.querySelector(".statusbox-body-game"),l=document.querySelector(".statusbox-body-connection"),f=document.querySelector(".statusbox-body-player"),p=function(e){function n(t,n){return e.call(this,t,n)||this}return a(n,e),n.prototype.beforeMoveApplied=function(){s&&(s.textContent="Dropping "+(0===this.currentPlayerId?"ðŸ”´":"ðŸ”µ")+" disc")},n.prototype.waitingForMove=function(){this.isMoveAllowed&&!this.isGameWon&&(s&&(s.textContent="Wating for move"),f&&(f.textContent=0===this.currentPlayerId?"Player 1 ðŸ”´":"Player 2 ðŸ”µ"))},n.prototype.afterMove=function(){},n.prototype.announceWinner=function(n){if(e.prototype.announceWinner.call(this,n),n!==t.BoardPiece.EMPTY){var r="<h1>Thank you for playing.</h1>";n===t.BoardPiece.DRAW?r+="It's a draw":r+="Player "+n+" wins",r+=".<br />After dismissing this message, click the board to reset game.",(0,o.showMessage)(r),s&&(s.textContent="Game over"),f&&(f.textContent=n===t.BoardPiece.DRAW?"It's a draw":"Player "+(n===t.BoardPiece.PLAYER_1?"1 ðŸ”´":"2 ðŸ”µ")+" wins")}},n}(n.GameBase);function y(n,a){var p=this,y=document.querySelector("canvas");if(y){var d=new e.Board(y),h=new r.PlayerHuman(t.BoardPiece.PLAYER_1),b=new n([h,a],d);null==u||u.classList.remove("hidden"),null==l||l.classList.add("hidden"),b.start(),s&&(s.textContent="Wating for move"),f&&(f.textContent="Player 1 ðŸ”´"),y.addEventListener("click",function(e){return i(p,void 0,void 0,function(){var t,n,i,u;return c(this,function(c){switch(c.label){case 0:return b.isGameWon?(b.reset(),[4,(0,o.animationFrame)()]):[3,2];case 1:return c.sent(),b.start(),[3,3];case 2:t=y.getBoundingClientRect(),n=e.clientX-t.left,i=e.clientY-t.top,u=(0,o.getColumnFromCoord)({x:n,y:i}),0===b.currentPlayerId?h.doAction(u):1===b.currentPlayerId&&a instanceof r.PlayerHuman&&a.doAction(u),c.label=3;case 3:return[2]}})})})}else console.error("Canvas DOM is null")}exports.GameLocal=p;
},{"../board":"fomW","@kenrick95/c4/src/board":"jQwk","@kenrick95/c4/src/game":"cPVS","@kenrick95/c4/src/player":"RSqW","@kenrick95/c4/src/utils":"sCpQ"}],"bVwI":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.initGameLocal2p=c;var r=require("@kenrick95/c4/src/board"),t=require("@kenrick95/c4/src/player"),e=require("./game-local"),n=function(){var r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,t){r.__proto__=t}||function(r,t){for(var e in t)Object.prototype.hasOwnProperty.call(t,e)&&(r[e]=t[e])})(t,e)};return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}}(),o=function(r){function t(){return null!==r&&r.apply(this,arguments)||this}return n(t,r),t}(e.GameLocal);function c(){(0,e.initGameLocal)(o,new t.PlayerHuman(r.BoardPiece.PLAYER_2))}
},{"@kenrick95/c4/src/board":"jQwk","@kenrick95/c4/src/player":"RSqW","./game-local":"nVOy"}],"LzVZ":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.initGameLocalAi=c;var r=require("@kenrick95/c4/src/board"),t=require("@kenrick95/c4/src/player"),e=require("./game-local"),o=function(){var r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,t){r.__proto__=t}||function(r,t){for(var e in t)Object.prototype.hasOwnProperty.call(t,e)&&(r[e]=t[e])})(t,e)};return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}}(),n=function(r){function t(){return null!==r&&r.apply(this,arguments)||this}return o(t,r),t}(e.GameLocal);function c(){(0,e.initGameLocal)(n,new t.PlayerAi(r.BoardPiece.PLAYER_2))}
},{"@kenrick95/c4/src/board":"jQwk","@kenrick95/c4/src/player":"RSqW","./game-local":"nVOy"}],"zOkM":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.initGameOnline2p=E,exports.GameOnline2p=void 0;var e,t=require("../board"),n=require("@kenrick95/c4/src/board"),o=require("@kenrick95/c4/src/game"),r=require("@kenrick95/c4/src/player"),a=require("@kenrick95/c4/src/utils"),c=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(t,n)};return function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function o(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),i=function(e,t,n,o){return new(n||(n=Promise))(function(r,a){function c(e){try{s(o.next(e))}catch(t){a(t)}}function i(e){try{s(o.throw(e))}catch(t){a(t)}}function s(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(c,i)}s((o=o.apply(e,t||[])).next())})},s=function(e,t){var n,o,r,a,c={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return a={next:i(0),throw:i(1),return:i(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function i(a){return function(i){return function(a){if(n)throw new TypeError("Generator is already executing.");for(;c;)try{if(n=1,o&&(r=2&a[0]?o.return:a[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,a[1])).done)return r;switch(o=0,r&&(a=[2&a[0],r.value]),a[0]){case 0:case 1:r=a;break;case 4:return c.label++,{value:a[1],done:!1};case 5:c.label++,o=a[1],a=[0];continue;case 7:a=c.ops.pop(),c.trys.pop();continue;default:if(!(r=(r=c.trys).length>0&&r[r.length-1])&&(6===a[0]||2===a[0])){c=0;continue}if(3===a[0]&&(!r||a[1]>r[0]&&a[1]<r[3])){c.label=a[1];break}if(6===a[0]&&c.label<r[1]){c.label=r[1],r=a;break}if(r&&c.label<r[2]){c.label=r[2],c.ops.push(a);break}r[2]&&c.ops.pop(),c.trys.pop();continue}a=t.call(e,c)}catch(i){a=[6,i],o=0}finally{n=r=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,i])}}};!function(e){e[e.FIRST=n.BoardPiece.PLAYER_1]="FIRST",e[e.SECOND=n.BoardPiece.PLAYER_2]="SECOND"}(e||(e={}));var l=document.querySelector(".statusbox"),u=document.querySelector(".statusbox-body-game"),d=document.querySelector(".statusbox-body-connection"),y=document.querySelector(".statusbox-body-player"),h="wss://c4-server.herokuapp.com/",p=function(t){function r(r,c,i){var s=i.gameMode,l=t.call(this,r,c)||this;return l.connectionPlayerId=null,l.connectionMatchId=null,l.ws=null,l.initMatch=function(){l.ws&&l.ws.send((0,o.constructMessage)(o.MESSAGE_TYPE.NEW_MATCH_REQUEST,{playerId:l.connectionPlayerId}))},l.connectToMatch=function(e){l.ws&&l.ws.send((0,o.constructMessage)(o.MESSAGE_TYPE.CONNECT_MATCH_REQUEST,{playerId:l.connectionPlayerId,matchId:e}))},l.messageActionHandler=function(t){var r;switch(t.type){case o.MESSAGE_TYPE.NEW_PLAYER_CONNECTION_OK:if(l.connectionPlayerId=t.payload.playerId,l.gameMode===e.FIRST)l.initMatch();else if(l.gameMode===e.SECOND){var c=new URLSearchParams(location.search).get("matchId");if(!c)return;l.connectToMatch(c)}break;case o.MESSAGE_TYPE.NEW_MATCH_OK:l.connectionMatchId=t.payload.matchId;var i=location.href+"?matchId="+l.connectionMatchId;console.log("[url] Share this",i),(0,a.showMessage)('<h1>Share this URL</h1>Please share this URL to your friend to start the game: <input type="text" id="copy-box" class="copy-box" readonly value="'+i+'" /><button type="button" id="copy-button">Copy</button>');var s=document.getElementById("copy-box");s.focus(),s.select(),null===(r=document.getElementById("copy-button"))||void 0===r||r.addEventListener("click",function(){null==s||s.select(),null==s||s.setSelectionRange(0,99999),document.execCommand("copy")});break;case o.MESSAGE_TYPE.CONNECT_MATCH_OK:l.connectionMatchId=t.payload.matchId;break;case o.MESSAGE_TYPE.CONNECT_MATCH_FAIL:(0,a.showMessage)("<h1>Error</h1> Failed to connect to match."),d&&(d.textContent="Connection error");break;case o.MESSAGE_TYPE.GAME_READY:(0,a.showMessage)("<h1>Game started</h1> The first piece should be dropped by "+(l.isCurrentMoveByCurrentPlayer()?"you":"the other player")),u&&(u.textContent="Wating for move"),y&&(y.textContent=(0===l.currentPlayerId?"Player 1 ðŸ”´":"Player 2 ðŸ”µ")+" "+(l.isCurrentMoveByCurrentPlayer()?"(you)":"(the other player)")),l.start();break;case o.MESSAGE_TYPE.MOVE_SHADOW:l.playerShadow.doAction(t.payload.column);break;case o.MESSAGE_TYPE.GAME_ENDED:var h=t.payload.winnerBoardPiece,p=h===n.BoardPiece.DRAW?"It's a draw":"Player "+(h===n.BoardPiece.PLAYER_1?"1 ðŸ”´":"2 ðŸ”µ")+" wins";(0,a.showMessage)("<h1>Thank you for playing</h1>"+p+"<br />Next game will be started in 10 seconds."),u&&(u.textContent="Game over"),y&&(y.textContent=p);break;case o.MESSAGE_TYPE.GAME_RESET:l.reset();break;case o.MESSAGE_TYPE.OTHER_PLAYER_HUNGUP:(0,a.showMessage)("<h1>Other player disconnected</h1> Please reload the page to start a new match")}},l.beforeMoveApplied=function(){u&&(u.textContent="Dropping "+(0===l.currentPlayerId?"ðŸ”´":"ðŸ”µ")+" disc")},l.waitingForMove=function(){u&&(u.textContent="Wating for move"),y&&(y.textContent=(0===l.currentPlayerId?"Player 1 ðŸ”´":"Player 2 ðŸ”µ")+" "+(l.isCurrentMoveByCurrentPlayer()?"(you)":"(the other player)"))},l.afterMove=function(e){l.ws&&l.isCurrentMoveByCurrentPlayer()&&l.ws.send((0,o.constructMessage)(o.MESSAGE_TYPE.MOVE_MAIN,{playerId:l.connectionPlayerId,matchId:l.connectionMatchId,column:e}))},l.gameMode=s,s===e.FIRST?(l.playerMain=r[0],l.playerShadow=r[1]):(l.playerMain=r[1],l.playerShadow=r[0]),l.initConnection(),l}return c(r,t),r.prototype.initConnection=function(){var e=this;this.connectionPlayerId=null,this.connectionMatchId=null,this.ws&&this.ws.close();var t=function(){e.isMoveAllowed=!1,d&&(d.textContent="Disconnected from server"),u&&(u.textContent="Game over"),y&&(y.textContent="Disconnected from match")};this.ws=new WebSocket(h),this.ws.addEventListener("message",function(t){e.messageActionHandler((0,o.parseMessage)(t.data))}),this.ws.addEventListener("open",function(){e.ws&&e.ws.send((0,o.constructMessage)(o.MESSAGE_TYPE.NEW_PLAYER_CONNECTION_REQUEST)),d&&(d.textContent="Connected to server")}),this.ws.addEventListener("close",function(e){console.log("[ws] close event",e),t()}),this.ws.addEventListener("error",function(){console.log("[ws] error event",event),t()})},r.prototype.isCurrentMoveByCurrentPlayer=function(){return this.currentPlayerId+1===this.gameMode},r.prototype.announceWinner=function(e){t.prototype.announceWinner.call(this,e)},r}(o.GameBase);function E(){var o=this,c=document.querySelector("canvas");if(c){var u=new URLSearchParams(location.search).get("matchId")?e.SECOND:e.FIRST,d=new t.Board(c),y=u===e.FIRST?[new r.PlayerHuman(n.BoardPiece.PLAYER_1),new r.PlayerShadow(n.BoardPiece.PLAYER_2)]:[new r.PlayerShadow(n.BoardPiece.PLAYER_1),new r.PlayerHuman(n.BoardPiece.PLAYER_2)],h=new p(y,d,{gameMode:u});null==l||l.classList.remove("hidden"),c.addEventListener("click",function(e){return i(o,void 0,void 0,function(){var t,n,o,r;return s(this,function(i){return h.isGameWon||(t=c.getBoundingClientRect(),n=e.clientX-t.left,o=e.clientY-t.top,r=(0,a.getColumnFromCoord)({x:n,y:o}),h.playerMain.doAction(r)),[2]})})})}else console.error("Canvas DOM is null")}exports.GameOnline2p=p;
},{"../board":"fomW","@kenrick95/c4/src/board":"jQwk","@kenrick95/c4/src/game":"cPVS","@kenrick95/c4/src/player":"RSqW","@kenrick95/c4/src/utils":"sCpQ"}],"zWgV":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("./game-local-2p");Object.keys(e).forEach(function(r){"default"!==r&&"__esModule"!==r&&(r in exports&&exports[r]===e[r]||Object.defineProperty(exports,r,{enumerable:!0,get:function(){return e[r]}}))});var r=require("./game-local-ai");Object.keys(r).forEach(function(e){"default"!==e&&"__esModule"!==e&&(e in exports&&exports[e]===r[e]||Object.defineProperty(exports,e,{enumerable:!0,get:function(){return r[e]}}))});var t=require("./game-online-2p");Object.keys(t).forEach(function(e){"default"!==e&&"__esModule"!==e&&(e in exports&&exports[e]===t[e]||Object.defineProperty(exports,e,{enumerable:!0,get:function(){return t[e]}}))});
},{"./game-local-2p":"bVwI","./game-local-ai":"LzVZ","./game-online-2p":"zOkM"}],"iMte":[function(require,module,exports) {

},{}],"EVxB":[function(require,module,exports) {
"use strict";require("es6-promise/auto"),require("url-search-params-polyfill");var e=t(require("./game")),r=require("./board");function n(e){if("function"!=typeof WeakMap)return null;var r=new WeakMap,t=new WeakMap;return(n=function(e){return e?t:r})(e)}function t(e,r){if(!r&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var t=n(r);if(t&&t.has(e))return t.get(e);var i={},a=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&Object.prototype.hasOwnProperty.call(e,o)){var u=a?Object.getOwnPropertyDescriptor(e,o):null;u&&(u.get||u.set)?Object.defineProperty(i,o,u):i[o]=e[o]}return i.default=e,t&&t.set(e,i),i}require("./style.css"),document.addEventListener("DOMContentLoaded",function(){var n=document.querySelector("canvas");if(n){if(new r.Board(n).render(),new URLSearchParams(location.search).get("matchId")){e.initGameOnline2p();var t=document.querySelector(".mode");t&&t.classList.add("hidden")}var i=document.querySelector(".mode-chooser-submit");i&&i.addEventListener("click",function(){var r=document.querySelector(".mode");if(r){for(var n=document.querySelectorAll(".mode-chooser-input"),t=null,i=0;i<n.length&&!(t=n[i].checked?n[i].value:null);i++);t||(t="offline-ai"),"offline-human"===t?e.initGameLocal2p():"offline-ai"===t?e.initGameLocalAi():"online-human"===t&&e.initGameOnline2p(),r.classList.add("invisible"),r.addEventListener("transitionend",function(){r.classList.add("hidden")})}})}else console.error("Canvas DOM is null")});
},{"es6-promise/auto":"rL8E","url-search-params-polyfill":"a0bR","./game":"zWgV","./board":"fomW","./style.css":"iMte"}]},{},["EVxB"], null)
//# sourceMappingURL=https://kenrick95.github.io/c4/dist/app.8ffd1f09.js.map